<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ay≈üe'ye √ñzel ‚ù§Ô∏è</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #ff5c8d;
            --secondary-color: #ff8fa3;
            --bg-gradient-start: #fff0f3;
            --bg-gradient-end: #ffe3e8;
            --text-color: #641e34;
            --glass-bg: rgba(255, 255, 255, 0.75);
            --glass-border: rgba(255, 255, 255, 0.6);
            --shadow: 0 8px 32px 0 rgba(255, 92, 141, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            user-select: none; /* Metin se√ßimini engelle (app hissi) */
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-end));
            color: var(--text-color);
            min-height: 100vh;
            /* Mobil tarayƒ±cƒ± √ßubuƒüu sorununu √ß√∂zer */
            min-height: 100dvh; 
            overflow-x: hidden;
            overflow-y: auto;
        }

        /* --- ARKAPLAN KALP ANƒ∞MASYONU --- */
        .heart-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
            overflow: hidden;
        }

        .floating-heart {
            position: absolute;
            bottom: -50px;
            font-size: 24px;
            color: rgba(255, 92, 141, 0.2);
            animation: floatUp linear infinite;
        }

        @keyframes floatUp {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            100% { transform: translateY(-110vh) rotate(360deg); opacity: 0; }
        }

        /* --- MODERN MEN√ú (NAVBAR) --- */
        nav {
            position: sticky;
            top: 15px;
            z-index: 1000;
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 10px 20px;
            margin: 0 auto;
            width: 90%;
            max-width: 500px;
            
            /* Glassmorphism Efekti */
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: 50px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.05);
        }

        nav button {
            background: transparent;
            border: none;
            font-family: 'Quicksand', sans-serif;
            font-weight: 700;
            font-size: 0.95rem;
            color: var(--text-color);
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        nav button.active {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 92, 141, 0.4);
            transform: scale(1.05);
        }

        /* --- SECTIONS GENEL YAPISI --- */
        .section {
            display: none;
            flex-direction: column;
            align-items: center;
            padding: 100px 20px 40px 20px; /* Navbar i√ßin √ºst bo≈üluk */
            min-height: 100dvh;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            animation: slideUp 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .section.active {
            display: flex;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- 1. ANASAYFA --- */
        h1 {
            font-family: 'Dancing Script', cursive;
            font-size: 4rem;
            color: #d6336c;
            margin-bottom: 30px;
            text-shadow: 2px 2px 0px rgba(255, 255, 255, 0.5);
            line-height: 1.2;
        }

        .hero-card {
            background: var(--glass-bg);
            padding: 40px 30px;
            border-radius: 30px;
            box-shadow: var(--shadow);
            border: 1px solid white;
            text-align: center;
            max-width: 100%;
        }

        .hero-text p {
            font-size: 1.2rem;
            line-height: 1.8;
            font-weight: 600;
        }

        /* --- 2. GALERƒ∞ --- */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            width: 100%;
        }

        .photo-card {
            background: white;
            padding: 15px;
            border-radius: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
            overflow: hidden;
        }

        .photo-card:hover {
            transform: translateY(-5px);
        }

        .photo-wrapper {
            width: 100%;
            height: 350px;
            overflow: hidden;
            border-radius: 15px;
        }

        .photo-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .photo-card:hover img {
            transform: scale(1.05);
        }

        .caption {
            margin-top: 15px;
            font-style: italic;
            color: var(--primary-color);
            font-weight: 600;
        }

        /* --- 3. OYUN ALANI (PROFESYONEL UI) --- */
        #game {
            justify-content: flex-start; /* Mobilde yukarƒ± yaslansƒ±n */
            padding-top: 80px;
        }

        .game-header {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            width: 100%;
            max-width: 400px;
            justify-content: center;
        }

        .stat-box {
            background: white;
            padding: 10px 25px;
            border-radius: 20px;
            font-weight: 700;
            color: var(--text-color);
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 100px;
        }

        .stat-label { font-size: 0.8rem; opacity: 0.7; text-transform: uppercase; letter-spacing: 1px; }
        .stat-value { font-size: 1.5rem; color: var(--primary-color); }

        #game-wrapper {
            position: relative;
            width: 100%;
            max-width: 400px; /* ƒ∞deal mobil oyun geni≈üliƒüi */
            /* En boy oranƒ± koruma: Telefon ekranƒ± kadar */
            aspect-ratio: 9/16; 
            background: #70c5ce;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
            overflow: hidden;
            border: 4px solid white;
            touch-action: none; /* Mobilde kaydƒ±rmayƒ± engeller */
        }

        canvas {
            display: block;
            width: 100%;
            height: 100%;
            /* Piksellerin net g√∂r√ºnmesi i√ßin */
            image-rendering: -webkit-optimize-contrast;
        }

        /* Overlay (Ba≈ülangƒ±√ß ve Biti≈ü Ekranƒ±) */
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.4);
            backdrop-filter: blur(4px);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 10;
            transition: opacity 0.3s;
        }

        .overlay.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .overlay h2 {
            font-family: 'Dancing Script', cursive;
            font-size: 3.5rem;
            color: white;
            text-shadow: 0 4px 10px rgba(0,0,0,0.3);
            margin-bottom: 10px;
            animation: pulse 1.5s infinite;
        }

        .overlay p {
            color: white;
            font-size: 1.2rem;
            margin-bottom: 25px;
            font-weight: 600;
        }

        .btn-play {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 50px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(255, 92, 141, 0.4);
            transition: transform 0.1s;
        }

        .btn-play:active { transform: scale(0.95); }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .controls-hint {
            margin-top: 20px;
            font-size: 0.9rem;
            opacity: 0.6;
            text-align: center;
        }

    </style>
</head>
<body>

    <div class="heart-bg" id="heartBg"></div>

    <nav>
        <button onclick="showSection('home')" class="active">Ana Sayfa</button>
        <button onclick="showSection('gallery')">G√ºzelliƒüin</button>
        <button onclick="showSection('game')">Oyun üéÆ</button>
    </nav>

    <div id="home" class="section active">
        <h1>Ay≈üe'm...</h1>
        <div class="hero-card">
            <div class="hero-text">
                <p>
                    Seninle ge√ßen her saniye, √∂mr√ºm√ºn en deƒüerli hediyesi.<br>
                    G√∂zlerin bana baktƒ±ƒüƒ±nda t√ºm d√ºnya duruyor sanki.<br><br>
                    Bu k√º√ß√ºk site, y√ºz√ºndeki o g√ºzel tebess√ºm√ºn sebebi olsun diye...<br>
                    Seni √ßok seviyorum. ‚ù§Ô∏è
                </p>
            </div>
        </div>
    </div>

    <div id="gallery" class="section">
        <h1 style="font-size: 3rem;">Seninle Her ≈ûey G√ºzel</h1>
        <div class="gallery-grid">
            <div class="photo-card">
                <div class="photo-wrapper">
                    <img src="foto1.jpg" alt="Ay≈üe" onerror="this.src='https://via.placeholder.com/300x400/ffccd5/590d22?text=Foto+1'">
                </div>
                <p class="caption">"G√ºl√º≈ü√ºnle ƒ±sƒ±nan bir d√ºnya..."</p>
            </div>
            <div class="photo-card">
                <div class="photo-wrapper">
                    <img src="foto2.jpg" alt="Ay≈üe" onerror="this.src='https://via.placeholder.com/300x400/ffccd5/590d22?text=Foto+2'">
                </div>
                <p class="caption">"Huzurun ta kendisi."</p>
            </div>
            <div class="photo-card">
                <div class="photo-wrapper">
                    <img src="foto3.jpg" alt="Ay≈üe" onerror="this.src='https://via.placeholder.com/300x400/ffccd5/590d22?text=Foto+3'">
                </div>
                <p class="caption">"En sevdiƒüim manzara."</p>
            </div>
            <div class="photo-card">
                <div class="photo-wrapper">
                    <img src="foto4.jpg" alt="Ay≈üe" onerror="this.src='https://via.placeholder.com/300x400/ffccd5/590d22?text=Foto+4'">
                </div>
                <p class="caption">"ƒ∞yi ki benimlesin."</p>
            </div>
            <div class="photo-card">
                <div class="photo-wrapper">
                    <img src="foto5.jpg" alt="Ay≈üe" onerror="this.src='https://via.placeholder.com/300x400/ffccd5/590d22?text=Foto+5'">
                </div>
                <p class="caption">"Sonsuza dek..."</p>
            </div>
        </div>
    </div>

    <div id="game" class="section">
        <div class="game-header">
            <div class="stat-box">
                <span class="stat-label">Skor</span>
                <span class="stat-value" id="scoreVal">0</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">Rekor</span>
                <span class="stat-value" id="bestVal">0</span>
            </div>
        </div>

        <div id="game-wrapper">
            <canvas id="gameCanvas"></canvas>
            
            <div id="overlay" class="overlay">
                <h2 id="msg-title">Flappy Ay≈üe</h2>
                <p id="msg-subtitle">Oynamak i√ßin Tƒ±kla</p>
                <button id="start-btn" class="btn-play">BA≈ûLA</button>
            </div>
        </div>
        <p class="controls-hint">Zƒ±plamak i√ßin ekrana herhangi bir yerine dokun</p>
    </div>

    <script>
        // --- 1. Sƒ∞TE ƒ∞≈ûLEVLERƒ∞ ---

        // B√∂l√ºm Ge√ßi≈üleri
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(sec => sec.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('nav button').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            if(sectionId === 'game') {
                resizeCanvas(); // Oyun ekranƒ±na ge√ßince boyutu ayarla
                resetGame(false); // Oyunu sƒ±fƒ±rla ama hemen ba≈ülatma
            }
        }

        // U√ßu≈üan Kalpler
        function createHearts() {
            const container = document.getElementById('heartBg');
            const heartCount = 15;
            
            for(let i=0; i<heartCount; i++) {
                const heart = document.createElement('div');
                heart.classList.add('floating-heart');
                heart.innerHTML = '‚ù§Ô∏è';
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.animationDuration = (Math.random() * 5 + 10) + 's';
                heart.style.fontSize = (Math.random() * 20 + 15) + 'px';
                heart.style.animationDelay = (Math.random() * 10) + 's';
                container.appendChild(heart);
            }
        }
        createHearts();

        // --- 2. PROFESYONEL OYUN MOTORU ---

        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const wrapper = document.getElementById("game-wrapper");

        // Y√ºksek √á√∂z√ºn√ºrl√ºk (Retina Display) Ayarƒ±
        function resizeCanvas() {
            const rect = wrapper.getBoundingClientRect();
            // Cihaz piksel oranƒ± (daha net g√∂r√ºnt√º i√ßin)
            const dpr = window.devicePixelRatio || 1;
            
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            
            // CSS boyutu
            canvas.style.width = rect.width + 'px';
            canvas.style.height = rect.height + 'px';
            
            // √áizim √∂l√ßeƒüini ayarla
            ctx.scale(dpr, dpr);
            
            // Oyun deƒüi≈ükenlerini ekran boyutuna g√∂re g√ºncelle
            GAME_WIDTH = rect.width;
            GAME_HEIGHT = rect.height;
            
            // Zemin pozisyonunu g√ºncelle
            fg.h = GAME_HEIGHT * 0.15; // Ekranƒ±n %15'i zemin
        }
        
        let GAME_WIDTH = 0;
        let GAME_HEIGHT = 0;

        // Oyun Durumlarƒ±
        const state = { current: 0, getReady: 0, game: 1, over: 2 };

        // Deƒüi≈ükenler
        let frames = 0;
        let score = 0;
        let highScore = localStorage.getItem('ayse_highscore') || 0;
        let difficultySpeed = 2; // Ba≈ülangƒ±√ß hƒ±zƒ±

        document.getElementById('bestVal').innerText = highScore;

        // Ses Motoru
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        
        function playTone(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain);
            gain.connect(audioCtx.destination);
            
            const now = audioCtx.currentTime;
            
            if (type === 'jump') {
                osc.frequency.setValueAtTime(350, now);
                osc.frequency.exponentialRampToValueAtTime(600, now + 0.15);
                gain.gain.setValueAtTime(0.3, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.15);
                osc.start(now);
                osc.stop(now + 0.15);
            } else if (type === 'score') {
                osc.frequency.setValueAtTime(800, now);
                gain.gain.setValueAtTime(0.1, now);
                gain.gain.linearRampToValueAtTime(0, now + 0.1);
                osc.start(now);
                osc.stop(now + 0.1);
            } else if (type === 'hit') {
                osc.type = 'sawtooth';
                osc.frequency.setValueAtTime(150, now);
                gain.gain.setValueAtTime(0.3, now);
                gain.gain.exponentialRampToValueAtTime(0.01, now + 0.3);
                osc.start(now);
                osc.stop(now + 0.3);
            }
        }

        // Resim Y√ºkleme
        const birdImg = new Image();
        birdImg.src = "ayse_game.png";

        // NESNELER
        
        const bird = {
            x: 50,
            y: 150,
            w: 45, // KU≈û BOYUTU B√úY√úT√úLD√ú (Eskiden 34)
            h: 45, 
            speed: 0,
            gravity: 0.35, // Yer√ßekimi dengelendi
            jump: -6.5,    // Zƒ±plama g√ºc√º dengelendi
            rotation: 0,
            
            draw: function() {
                ctx.save();
                ctx.translate(this.x, this.y);
                ctx.rotate(this.rotation);
                
                if(birdImg.complete && birdImg.naturalHeight !== 0) {
                    // G√∂lge efekti ekle
                    ctx.shadowColor = "rgba(0,0,0,0.2)";
                    ctx.shadowBlur = 10;
                    ctx.drawImage(birdImg, -this.w/2, -this.h/2, this.w, this.h);
                } else {
                    // Yedek √áizim
                    ctx.fillStyle = "#ff5c8d";
                    ctx.beginPath();
                    ctx.arc(0,0, this.w/2, 0, Math.PI*2);
                    ctx.fill();
                    ctx.fillStyle = "white";
                    ctx.beginPath();
                    ctx.arc(8,-8, 6, 0, Math.PI*2);
                    ctx.fill();
                }
                ctx.restore();
            },
            
            flap: function() {
                this.speed = this.jump;
                playTone('jump');
            },
            
            update: function() {
                // Fizik hesaplamalarƒ±
                if (state.current === state.getReady) {
                    this.y = GAME_HEIGHT / 2 - 50;
                    this.rotation = 0;
                    // Bekleme ekranƒ±nda hafif s√ºz√ºlme animasyonu
                    this.y += Math.cos(frames/15) * 1.5; 
                } else {
                    this.speed += this.gravity;
                    this.y += this.speed;

                    // D√∂n√º≈ü a√ßƒ±sƒ±
                    if(this.speed < this.jump/2) {
                        this.rotation = -25 * Math.PI / 180;
                    } else {
                        this.rotation += 4 * Math.PI / 180;
                        this.rotation = Math.min(Math.PI / 2, this.rotation);
                    }

                    // Zemin √ßarpƒ±≈ümasƒ±
                    if(this.y + this.h/2 >= GAME_HEIGHT - fg.h) {
                        this.y = GAME_HEIGHT - fg.h - this.h/2;
                        if(state.current === state.game) {
                            state.current = state.over;
                            playTone('hit');
                            showGameOver();
                        }
                    }
                }
            }
        };

        const fg = {
            h: 100, // Dinamik olarak resizeCanvas'ta ayarlanƒ±r
            draw: function() {
                ctx.fillStyle = "#e0d68a";
                ctx.fillRect(0, GAME_HEIGHT - this.h, GAME_WIDTH, this.h);
                // √áimen √ºst√º
                ctx.fillStyle = "#73bf2e";
                ctx.fillRect(0, GAME_HEIGHT - this.h, GAME_WIDTH, 12);
                // √áimen deseni (hafif √ßizgiler)
                ctx.strokeStyle = "#65a828";
                ctx.beginPath();
                for(let i=0; i<GAME_WIDTH; i+=20) {
                    ctx.moveTo(i, GAME_HEIGHT - this.h);
                    ctx.lineTo(i+10, GAME_HEIGHT - this.h + 12);
                }
                ctx.stroke();
            }
        };

        const pipes = {
            position: [],
            w: 60, // Borular biraz daha kalƒ±n
            h: 400,
            gap: 140, // Bo≈üluk biraz daha geni≈ü (oynanabilirlik i√ßin)
            
            draw: function() {
                for(let i=0; i<this.position.length; i++) {
                    let p = this.position[i];
                    let topY = p.y;
                    let bottomY = p.y + this.h + this.gap;
                    
                    // Boru G√∂vdesi (Gradyan)
                    let grd = ctx.createLinearGradient(p.x, 0, p.x + this.w, 0);
                    grd.addColorStop(0, "#558c22");
                    grd.addColorStop(0.5, "#9ce659"); // Parlama efekti
                    grd.addColorStop(1, "#558c22");
                    ctx.fillStyle = grd;
                    
                    ctx.fillRect(p.x, topY, this.w, this.h);
                    ctx.fillRect(p.x, bottomY, this.w, this.h);
                    
                    // Boru Ba≈ülƒ±klarƒ±
                    ctx.fillStyle = "#46731d"; 
                    ctx.fillRect(p.x-3, topY+this.h-25, this.w+6, 25);
                    ctx.fillRect(p.x-3, bottomY, this.w+6, 25);
                    
                    // Ba≈ülƒ±k i√ßi detay
                    ctx.fillStyle = "#8ad14b";
                    ctx.fillRect(p.x, topY+this.h-22, this.w, 3);
                    ctx.fillRect(p.x, bottomY+3, this.w, 3);
                }
            },
            
            update: function() {
                if(state.current !== state.game) return;
                
                // Boru Ekleme (Ekran geni≈üliƒüine g√∂re sƒ±klƒ±k ayarƒ±)
                if(frames % 100 === 0) {
                    this.position.push({
                        x: GAME_WIDTH,
                        y: -150 * (Math.random() + 1)
                    });
                }
                
                for(let i=0; i<this.position.length; i++) {
                    let p = this.position[i];
                    
                    // HIZLANMA MANTIƒûI: Skor arttƒ±k√ßa dx artar
                    // Base hƒ±z: 2.5, Her 5 puanda 0.1 artar
                    let currentSpeed = 2.5 + (Math.floor(score / 5) * 0.15);
                    p.x -= currentSpeed;

                    // √áarpƒ±≈üma (Hitbox biraz k√º√ß√ºlt√ºld√º - forgiving gameplay)
                    let hitbox = 10; // Ku≈üun kenarlarƒ±ndan 10px bo≈üluk
                    if(bird.x + bird.w/2 - hitbox > p.x && 
                       bird.x - bird.w/2 + hitbox < p.x + this.w &&
                       (bird.y - bird.h/2 + hitbox < p.y + this.h || 
                        bird.y + bird.h/2 - hitbox > p.y + this.h + this.gap)) {
                        state.current = state.over;
                        playTone('hit');
                        showGameOver();
                    }

                    // Skor
                    if(p.x + this.w < bird.x && p.x + this.w + currentSpeed >= bird.x) {
                        score++;
                        playTone('score');
                        document.getElementById('scoreVal').innerText = score;
                        highScore = Math.max(score, highScore);
                        localStorage.setItem('ayse_highscore', highScore);
                        document.getElementById('bestVal').innerText = highScore;
                    }

                    // Temizleme
                    if(p.x + this.w <= 0) {
                        this.position.shift();
                        i--;
                    }
                }
            },
            reset: function() { this.position = []; }
        };

        const bg = {
            draw: function() {
                // G√∂ky√ºz√º
                ctx.fillStyle = "#70c5ce"; 
                ctx.fillRect(0, 0, GAME_WIDTH, GAME_HEIGHT);
                
                // Bulutlar (Prosed√ºrel √áizim)
                ctx.fillStyle = "rgba(255,255,255,0.7)";
                
                // Arka planda hareket eden bulutlar
                let cloudOffset = (frames * 0.5) % (GAME_WIDTH + 200);
                this.drawCloud(GAME_WIDTH - cloudOffset, 80, 0.8);
                this.drawCloud((GAME_WIDTH/2) - cloudOffset, 150, 0.6);
                this.drawCloud((GAME_WIDTH + 300) - cloudOffset, 50, 1);
            },
            
            drawCloud: function(x, y, scale) {
                ctx.save();
                ctx.translate(x, y);
                ctx.scale(scale, scale);
                ctx.beginPath();
                ctx.arc(0, 0, 30, 0, Math.PI*2);
                ctx.arc(40, 10, 35, 0, Math.PI*2);
                ctx.arc(80, 0, 30, 0, Math.PI*2);
                ctx.fill();
                ctx.restore();
            }
        };

        // --- OYUN D√ñNG√úS√ú ---
        function loop() {
            bg.draw();
            pipes.draw();
            fg.draw();
            bird.draw();
            
            bird.update();
            pipes.update();
            
            frames++;
            requestAnimationFrame(loop);
        }

        // Ba≈ülat
        window.onload = function() {
            resizeCanvas();
            window.addEventListener('resize', resizeCanvas);
            loop();
        };

        // --- KONTROLLER ---
        const startBtn = document.getElementById("start-btn");
        const msgTitle = document.getElementById("msg-title");
        const msgSub = document.getElementById("msg-subtitle");
        const overlay = document.getElementById("overlay");

        function handleInput(e) {
            // Sadece oyun sekmesi aktifse √ßalƒ±≈ü
            if(!document.getElementById('game').classList.contains('active')) return;

            // Space tu≈üu dƒ±≈üƒ±ndakileri yoksay (Klavye i√ßin)
            if(e.type === 'keydown' && e.code !== 'Space') return;
            
            // Varsayƒ±lan kaydƒ±rma vb. engelle
            if(e.type !== 'click') { 
                if(e.cancelable) e.preventDefault(); 
            }

            switch (state.current) {
                case state.getReady:
                    state.current = state.game;
                    overlay.classList.add('hidden'); // Yumu≈üak gizleme
                    playTone('jump');
                    break;
                case state.game:
                    bird.flap();
                    break;
                case state.over:
                    // Hemen tekrar ba≈ülamasƒ±n, hafif gecikme (yanlƒ±≈ü tƒ±klamayƒ± √∂nler)
                    // ResetGame butonu ile √ßalƒ±≈üƒ±r
                    break;
            }
        }

        // Event Listeners (Geli≈ümi≈ü)
        startBtn.addEventListener("click", () => {
            if(state.current === state.over) resetGame();
            else handleInput({type: 'click'});
        });
        
        // Ekrana dokunma (Mobil)
        wrapper.addEventListener("touchstart", handleInput, {passive: false});
        // Mouse tƒ±klama (Masa√ºst√º)
        wrapper.addEventListener("mousedown", handleInput);
        // Klavye
        window.addEventListener("keydown", handleInput);

        function resetGame(startImmediately = true) {
            bird.speed = 0;
            bird.rotation = 0;
            pipes.reset();
            score = 0;
            frames = 0;
            difficultySpeed = 2; // Hƒ±zƒ± sƒ±fƒ±rla
            document.getElementById('scoreVal').innerText = score;
            
            state.current = state.getReady;
            
            // UI G√ºncelle
            overlay.classList.remove('hidden');
            if(startImmediately) {
                msgTitle.innerText = "Flappy Ay≈üe";
                msgSub.innerText = "Oynamak i√ßin Tƒ±kla";
                startBtn.innerText = "BA≈ûLA";
            } else {
                // Sekme deƒüi≈üikliƒüinde temiz durum
                msgTitle.innerText = "Flappy Ay≈üe";
                msgSub.innerText = "Oynamak i√ßin Tƒ±kla";
                startBtn.innerText = "BA≈ûLA";
            }
        }

        function showGameOver() {
            overlay.classList.remove('hidden');
            msgTitle.innerText = "Oyun Bitti!";
            msgSub.innerText = "Skorun: " + score;
            startBtn.innerText = "TEKRAR DENE";
        }
    </script>
</body>
</html>
